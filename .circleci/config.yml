version: 2
jobs:
  build:
    machine:
      enabled: true
      image: circleci/classic:201711-01
    steps:
      - checkout
      - run:
          name: check ssh
          command: ls ~/.ssh
      - run:
          name: check config
          command: cat ~/.ssh/config
      - run:
          name: build container
          command: docker build -t nagamatu/loopback .
      - run:
          name: run container
          command: docker run --env CIRCLE_PROJECT_USERNAME=${CIRCLE_PROJECT_USERNAME} --env CI_PROJECT_REPONAME=${CI_PROJECT_REPONAME} --privileged -t nagamatu/loopback
      - run:
          name: Print the Current Time
          command: date
